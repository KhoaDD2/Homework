package com.khoadd2.nojumpstarts;

import androidx.appcompat.app.AppCompatActivity;

import android.content.ComponentName;
import android.content.Intent;
import android.os.Bundle;
import android.util.Log;

public class MainActivity extends AppCompatActivity {
    private static final String TAG = "MOBISEC";
    public static byte[] hexStringToByteArray(String s) {
        int len = s.length();
        byte[] data = new byte[len / 2];
        for (int i = 0; i < len; i += 2) {
            data[i / 2] = (byte) ((Character.digit(s.charAt(i), 16) << 4)
                    + Character.digit(s.charAt(i+1), 16));
        }
        return data;
    }

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        Log.d(TAG,"Start activity C");
        String msg = "Main-to-A/A-to-B/B-to-C";
        byte[] sign = hexStringToByteArray("6112E12C49EB99B65270A2E961840DB83A6459249F0512CC6F9AEB5F7993994559A62A53E1D56DC2F5F13F45AC17DEEAB8565FB9B1F7DA1B3BA24ACAA3D3B861195A604F8090D95CDDF519302DCBD420FCFBE3CA603B954F55FCBF7C06CD6841A408D66715188893FAC0E7692F3A01C907263DFF4805A9B42FBE0A91C3514BCCC6BC1F0C797759ED65FD213468DA0BD0448C2F9D58448B03C72918B11F6E9428BE0778735626401BB904FAB875F1D628AEE3B93008980976A4FD1CE237B786EFC8F4511D0030CED81A665A5B2EEE3CB29ABC44AA18A914C9381B69965706DF8DC61DECB7E22B3A82678984F6C5052C52770228B2D1FB6AD6FE7407C9790655E0");
        Intent i = new Intent();
        i.setComponent(new ComponentName("com.mobisec.nojumpstarts", "com.mobisec.nojumpstarts.C"));
        i.setAction("mobisec.intent.getflag");
        i.putExtra("authmsg", msg);
        i.putExtra("authsign", sign);
        startActivityForResult(i, 402);
    }
    @Override // android.support.v4.app.FragmentActivity
    public void onActivityResult(int requestCode, int resultCode, Intent data) {
        super.onActivityResult(requestCode, resultCode, data);
        if (requestCode == 402) {
            String flag2 = data.getStringExtra("flag");
            Log.d(TAG,"f: " + flag2);
        }
    }
}